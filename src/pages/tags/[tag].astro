---
import BaseLayout from "./../../layouts/BaseLayout.astro";

export async function getStaticPaths() {
  
  const allPosts = await Astro.glob('../posts/*.md'); // returns an array of posts from location specified
  
  const allTags = new Set()
 
  allPosts.map(post => {
      post.frontmatter.tags && post.frontmatter.tags.map(tag => allTags.add(tag.toLowerCase()))
  })


  return Array.from(allTags).map((tag) => {
    const filteredPosts = allPosts.filter((post) => post.frontmatter.tags.includes(tag))
    
    return filteredPosts.map((post) => ({
        params: { tag },
        props: { filteredPosts }
    }))
  })
}

const { tag } = Astro.params
const { filteredPosts } = Astro.props
---

<BaseLayout title="DW Blog-Tags">

<div>
<h1>Blog posts with {tag} in tags</h1>
<ul>
  {filteredPosts.map((post) => (
        <li>
          <a href={post.url}>{post.frontmatter.title}</a>
        </li>
  ))}
</ul>

</div>




</BaseLayout>

<style>
  ul {
    list-style-type: none;
  }
  
  </style>









